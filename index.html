<!DOCTYPE html>
<html>
<head>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
<title>Ganlv&#39;s Blog</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<meta name="description" content="Hello everyone. This is Ganlv. Welcome to my static blog. Comment is not available now. The blog is under built. I will find or build a beautiful theme later. If you like my projects on GitHub, giving">
<meta name="keywords" content="php,javascript,node,node.js,laravel,open source,hexo">
<meta property="og:type" content="website">
<meta property="og:title" content="Ganlv&#39;s Blog">
<meta property="og:url" content="https://ganlvtech.github.io/index.html">
<meta property="og:site_name" content="Ganlv&#39;s Blog">
<meta property="og:description" content="Hello everyone. This is Ganlv. Welcome to my static blog. Comment is not available now. The blog is under built. I will find or build a beautiful theme later. If you like my projects on GitHub, giving">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ganlv&#39;s Blog">
<meta name="twitter:description" content="Hello everyone. This is Ganlv. Welcome to my static blog. Comment is not available now. The blog is under built. I will find or build a beautiful theme later. If you like my projects on GitHub, giving">
<link rel="alternate" href="/atom.xml" title="Ganlv&#39;s Blog" type="application/atom+xml">
<link rel="icon" href="/favicon.png">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
</html>
<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
<div id="wrap">
<header id="header">
<div id="banner"></div>
<div id="header-outer" class="outer">
<div id="header-title" class="inner">
<h1 id="logo-wrap">
<a href="/" id="logo">Ganlv&#39;s Blog</a>
</h1>
</div>
<div id="header-inner" class="inner">
<nav id="main-nav">
<a id="main-nav-toggle" class="nav-icon"></a>
<a class="main-nav-link" href="/">Home</a>
<a class="main-nav-link" href="/archives">Archives</a>
</nav>
<nav id="sub-nav">
<a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
<a id="nav-search-btn" class="nav-icon" title="搜索"></a>
</nav>
<div id="search-form-wrap">
<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://ganlvtech.github.io"></form>
</div>
</div>
</div>
</header>
<div class="outer">
<section id="main">
<article id="post-chrome-local-override" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/10/15/chrome-local-override/" class="article-date">
<time datetime="2018-10-15T20:46:09.000Z" itemprop="datePublished">2018-10-16</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/10/15/chrome-local-override/">Chrome Local Override 本地文件替换</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>我们修改前端的时候，经常遇到一种情况。本地的测试服务器的数据并不是很充足，很多情况是线上的数据引发的问题，如果把线上的数据离线下来会很麻烦。</p>
<p>具体一点，比如我帮别人改他的网站的 js、css，我并不能访问他的数据库。如果我想模拟线上环境，我要么爬取数据，要么自己伪造数据。</p>
<p>还有，如果我想改别人网站的 js 代码，想简单调试一下，最后再做一个插件。我并不想把他整个网站都离线下来，然后本地测试。我想做的只是改某一个文件。</p>
<p>另外，比如 ajax.googleapis.com 被墙了，我想使用 ajax.proxy.ustclug.org 的镜像代替对应的文件。</p>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/10/15/chrome-local-override/" data-id="cjnau2cve0001w0ozv6vqkeon" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/chrome/">chrome</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/devtools/">devtools</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/frontend/">frontend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gfw/">gfw</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gooreplacer/">gooreplacer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/html/">html</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/production/">production</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/resource-override/">resource-override</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test/">test</a></li></ul>
</footer>
</div>
</article>
<article id="post-install-pure-ftpd-enable-tls" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/10/08/install-pure-ftpd-enable-tls/" class="article-date">
<time datetime="2018-10-08T17:38:17.000Z" itemprop="datePublished">2018-10-09</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/10/08/install-pure-ftpd-enable-tls/">安装 Pure-FTPd 并启用 TLS</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<div class="toc">
<ul>
<li><a href="#an-zhuang-pure-ftpd">安装 Pure-FTPd</a><ul>
<li><a href="#cha-kan-yi-xia-duan-kou">查看一下端口</a></li>
<li><a href="#chang-shi-lian-jie-yi-xia">尝试连接一下</a></li>
<li><a href="#qi-yong-xu-ni-zhang-hu">启用虚拟账户</a></li>
<li><a href="#chong-qi-ftp-fu-wu-qi">重启 FTP 服务器</a></li>
<li><a href="#tian-jia-zhang-hao">添加账号</a></li>
</ul>
</li>
<li><a href="#pei-zhi-tls">配置 TLS</a><ul>
<li><a href="#qi-yong-qiang-zhi-tls">启用强制 TLS</a></li>
<li><a href="#sheng-cheng-zheng-shu">生成证书</a></li>
<li><a href="#chong-qi-ftp-fu-wu-qi-1">重启 FTP 服务器</a></li>
</ul>
</li>
<li><a href="#da-gong-gao-cheng">大功告成</a></li>
<li><a href="#guan-yu-pure-ftpd-de-pei-zhi-wen-jian">关于 Pure-FTPd 的配置文件</a></li>
</ul>
</div>
<p>我使用的系统是 Ubuntu Server 18.04 LTS。</p>
<blockquote>
<p>其实我用的是 <a href="https://laravel.com/docs/5.7/homestead" target="_blank" rel="noopener">Laravel Homestead</a> 的 <a href="https://www.vagrantup.com/" target="_blank" rel="noopener">Vagrant</a> <a href="https://app.vagrantup.com/laravel/boxes/homestead" target="_blank" rel="noopener">Box</a>，一个非常方便的虚拟机。</p>
</blockquote>
<p>本文参考了 <a href="https://www.pureftpd.org/" target="_blank" rel="noopener">Pure-FTPd</a> 的 <a href="https://help.ubuntu.com/community/PureFTP" target="_blank" rel="noopener">Ubuntu Community Wiki</a></p>
<h2><span id="an-zhuang-pure-ftpd">安装 Pure-FTPd</span><a href="#an-zhuang-pure-ftpd" class="header-anchor">#</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install pure-ftpd</span><br></pre></td></tr></table></figure>
<h3><span id="cha-kan-yi-xia-duan-kou">查看一下端口</span><a href="#cha-kan-yi-xia-duan-kou" class="header-anchor">#</a></h3><p>这是一个很常见的指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -tlnp</span><br></pre></td></tr></table></figure>
<ul>
<li><code>t</code> 表示 TCP，只显示 TCP 连接</li>
<li><code>l</code> 表示 listening，只显示正在监听的 Socket</li>
<li><code>n</code> 表示 numeric，就是只显示 IP 数值，不解析域名</li>
<li><code>p</code> 表示 programs 显示 PID/Program name</li>
</ul>
<p>可以看到其中这两行，表示 Pure-FTPd 在对外监听 IPv4 和 IPv6 的 21 端口。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br><span class="line">tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      2663/pure-ftpd (SER</span><br><span class="line">tcp6       0      0 :::21                   :::*                    LISTEN      2663/pure-ftpd (SER</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Local Address 是 <code>0.0.0.0</code> 表示对外监听，如果是 <code>127.0.0.1</code> 的话就是只监听本机，外部的请求无法访问到这个端口。</p>
</blockquote>
<h3><span id="chang-shi-lian-jie-yi-xia">尝试连接一下</span><a href="#chang-shi-lian-jie-yi-xia" class="header-anchor">#</a></h3><p>我们可以用 <a href="https://filezilla-project.org/" target="_blank" rel="noopener">FileZilla</a> 连接一下试试。</p>
<p>暂时用匿名用户 <code>anonymous</code> 登录，可以看到服务器回应 <code>Login authentication failed</code>，证明服务器是安装成功了，但是还没创建 FTP 用户呢。</p>
<blockquote>
<p>Laravel Homestead 虚拟机默认的 IP 是 <code>192.168.10.10</code>。</p>
</blockquote>
<h3><span id="qi-yong-xu-ni-zhang-hu">启用虚拟账户</span><a href="#qi-yong-xu-ni-zhang-hu" class="header-anchor">#</a></h3><p>Pure-FTPd 可以使用虚拟账户，这个账户与 Linux 系统的账户无关，仅仅用于 FTP 登录验证。你可以很多 FTP 账户而不会把系统弄乱。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /etc/pure-ftpd/conf/PureDB /etc/pure-ftpd/auth/PureDB</span><br></pre></td></tr></table></figure>
<h3><span id="chong-qi-ftp-fu-wu-qi">重启 FTP 服务器</span><a href="#chong-qi-ftp-fu-wu-qi" class="header-anchor">#</a></h3><p>重启 FTP 服务器，应用配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service pure-ftpd restart</span><br></pre></td></tr></table></figure>
<h3><span id="tian-jia-zhang-hao">添加账号</span><a href="#tian-jia-zhang-hao" class="header-anchor">#</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pure-pw useradd ganlv -u vagrant -d /home/vagrant/</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ganlv</code> 是我一会 FTP 登录时输入的用户名。</li>
<li><code>vagrant</code> 表示用哪个 Linux 系统账户来完成 FTP 文件操作。</li>
<li><code>/home/vagrant/</code> 表示登录 FTP 之后的根目录 <code>/</code>。</li>
</ul>
<p>Linux 下每个文件和文件夹都有用户和用户组，所以需要特定用户才能操作。虽然有虚拟账户系统，但是还是需要用一个系统账户来进行操作的，总不能用 root 账户来操作吧。</p>
<blockquote>
<p>其实在登录之后，<code>pure-ftpd</code> 会用权限较低用户（就是设置的 <code>vagrant</code>）创建一个新进程来执行操作，保证以较低的权限来执行操作。</p>
</blockquote>
<p>然后输入两遍密码就创建完成了。</p>
<p>其实，这时还是登录不上的。还需要把文本文件 <code>/etc/pure-ftpd/pureftpd.passwd</code> 转换成 <code>/etc/pure-ftpd/pureftpd.pdb</code>，后面的 PDB 文件才是程序真正读取的用户数据库。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pure-pw mkdb</span><br></pre></td></tr></table></figure>
<p>可以在添加账号时直接使用 <code>-m</code> 直接 <code>mkdb</code>，把两步合并成一步。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pure-pw useradd ganlv -u vagrant -d /home/vagrant/ -m</span><br></pre></td></tr></table></figure>
<p>添加账号并不需要重启 FTP 服务器。</p>
<h2><span id="pei-zhi-tls">配置 TLS</span><a href="#pei-zhi-tls" class="header-anchor">#</a></h2><h3><span id="qi-yong-qiang-zhi-tls">启用强制 TLS</span><a href="#qi-yong-qiang-zhi-tls" class="header-anchor">#</a></h3><p>这部分需要使用 root 用户来操作，但是 sudo 又不是很方便，所以直接用 <code>su</code> 切换到 root。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 2 &gt; /etc/pure-ftpd/conf/TLS</span><br></pre></td></tr></table></figure>
<p>如果想既允许普通的 FTP 又支持 FTPS，那就用 <code>echo 1</code>。</p>
<p>然后 <code>exit</code> 退出 root 账户。</p>
<h3><span id="sheng-cheng-zheng-shu">生成证书</span><a href="#sheng-cheng-zheng-shu" class="header-anchor">#</a></h3><p>然后去生成一个自签发的证书。</p>
<p>如果 <code>/etc/ssl/private/</code> 这个目录不存在的话就新建一个。如果存在的话就没事了。要注意这个目录的权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/ssl/private/</span><br><span class="line">chown root:root /etc/ssl/private/</span><br><span class="line">chmod 700 /etc/ssl/private/</span><br></pre></td></tr></table></figure>
<p>我的 Ubuntu 是自带这个目录的，默认是 <code>root:ssl-cert 710</code> 的权限，和 <a href="https://serverfault.com/questions/259302/best-location-for-ssl-certificate-and-private-keys-on-ubuntu/259307#259307" target="_blank" rel="noopener">StackOverflow 上的一个答案</a> 差不多。我感觉不到什么区别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drwx--x---   2 root ssl-cert  4096 Jun  3 19:59 private</span><br></pre></td></tr></table></figure>
<p>用 openssl 生成证书，填好证书的各种信息，不想看的话就一直回车就行了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/pure-ftpd.pem -out /etc/ssl/private/pure-ftpd.pem</span><br></pre></td></tr></table></figure>
<h3><span id="chong-qi-ftp-fu-wu-qi">重启 FTP 服务器</span><a href="#chong-qi-ftp-fu-wu-qi" class="header-anchor">#</a></h3><p>凡是修改配置文件，肯定要重启，因为配置文件只在程序启动的时候加载，之后就不会再读取配置了。</p>
<h2><span id="da-gong-gao-cheng">大功告成</span><a href="#da-gong-gao-cheng" class="header-anchor">#</a></h2><p>FileZilla 连接一下试一试</p>
<p><img src="/images/install-pure-ftpd-enable-tls/filezilla-connect.jpg" alt="使用 Pure-FTPd 连接到 FTP 服务器"></p>
<p>确定即可，信任这个证书，以后就不会再提示了。</p>
<p>站点管理器中也可以要求显式的 FTP 通过 TLS。</p>
<p><img src="/images/install-pure-ftpd-enable-tls/filezilla-explicit-tls.jpg" alt="要求显式的 FTP 通过 TLS"></p>
<h2><span id="guan-yu-pure-ftpd-de-pei-zhi-wen-jian">关于 Pure-FTPd 的配置文件</span><a href="#guan-yu-pure-ftpd-de-pei-zhi-wen-jian" class="header-anchor">#</a></h2><p>Pure-FTPd 并不是使用 <code>/etc/pure-ftpd/pure-ftpd.conf</code> 来作为配置文件，可以看 <code>pure-ftpd.conf</code> 这个文件的开头的说明。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># If you want to run Pure-FTPd with this configuration</span><br><span class="line"># instead of command-line options, please run the</span><br><span class="line"># following command :</span><br><span class="line">#</span><br><span class="line"># /usr/sbin/pure-ftpd /etc/pure-ftpd/etc/pure-ftpd.conf</span><br></pre></td></tr></table></figure>
<p>如果你想用这个配置文件运行 Pure-FTPd，你必须要在命令行后面加上这个文件路径作为参数。</p>
<p>如果你不用这个配置文件，直接修改 <code>/etc/pure-ftpd/conf/</code> 下的文件内容就行。</p>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/10/08/install-pure-ftpd-enable-tls/" data-id="cjnau2cvr0007w0oz3cbpj6e2" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ftp/">ftp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pure-ftpd/">pure-ftpd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssl/">ssl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tls/">tls</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
</footer>
</div>
</article>
<article id="post-ubuntu-font-noto-sans-cjk-problem" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/28/ubuntu-font-noto-sans-cjk-problem/" class="article-date">
<time datetime="2018-09-28T23:25:00.000Z" itemprop="datePublished">2018-09-29</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/28/ubuntu-font-noto-sans-cjk-problem/">Ubuntu Use Noto Sans CJK SC as Default Fallback Font</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p><a href="https://www.zhihu.com/question/47141667" target="_blank" rel="noopener">如何正确为 Noto Sans CJK 配置 fontconfig 使中文不会被显示为日文字型？</a></p>
<h2><span id="how-to">How to</span><a href="#how-to" class="header-anchor">#</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/fonts/conf.d/64-language-selector-prefer.conf</span><br></pre></td></tr></table></figure>
<p>Use <code>dd</code> (delete a whole line) and <code>p</code> (paste) to move <code>Noto Sans CJK SC</code> to the first. And then <code>:wq</code> (write and quite). Restart running program may apply the changes.</p>
<h2><span id="about-the-default-order">About The Default Order</span><a href="#about-the-default-order" class="header-anchor">#</a></h2><p><code>JP, KR, SC, TC</code>. They are sorted by alphabet. So a newly installed copy of Ubuntu would prefer <code>Noto Sans CJK JP</code> as default fallback font.</p>
<blockquote>
<p><code>CJK</code>, <code>Chinese, Japanese, Korean</code>, is also sorted by alphabet resulting in Chinese <code>C</code> first.</p>
</blockquote>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/28/ubuntu-font-noto-sans-cjk-problem/" data-id="cjnau2cvt0008w0oz47iwmbki" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/i18n/">i18n</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/locale/">locale</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
</footer>
</div>
</article>
<article id="post-hexo-deploy-vs-travis-pages-provider" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/24/hexo-deploy-vs-travis-pages-provider/" class="article-date">
<time datetime="2018-09-24T13:54:53.000Z" itemprop="datePublished">2018-09-24</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/24/hexo-deploy-vs-travis-pages-provider/">hexo deploy v.s. Travis Pages provider</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>之前用的是 Hexo 自带的 <code>hexo deploy</code> 来部署 GitHub Pages，这个配置文件显得很不美观。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">before_script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="bullet">-g</span> <span class="string">hexo-cli</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"Ganlv"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"nospam@example.com"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">sed</span> <span class="bullet">-i</span> <span class="string">"s/git@github.com:/https:\/\/$&#123;__GITHUB_TOKEN__&#125;@github.com\//"</span> <span class="string">_config.yml</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">clone</span> <span class="bullet">-b</span> <span class="string">master</span> <span class="attr">https://github.com/ganlvtech/ganlvtech.github.io.git</span> <span class="string">.deploy_git</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">deploy</span></span><br></pre></td></tr></table></figure>
<p>通过 <code>sed</code> 来修改 <code>_config.yml</code> 的内容，把环境变量 <code>__GITHUB_TOKEN__</code> 嵌入到 git 仓库的地址当中，然后手动把仓库克隆下来保留提交历史。</p>
<p>而且也不知道是不是因为使用了 <code>nospam</code> 的邮箱，GitHub 无法识别我这个提交的来源用户，就将提交者的视为陌生人了。</p>
<p><img src="/images/hexo-deploy-vs-travis-pages-provider/different-committers.jpg" alt="hexo deploy travis pages provider different committers"></p>
<p>于是，我就想，hexo 只负责生成静态页面，部署到 GitHub Pages 使用 Travis CI 的 Pages Provider，这样提交者会显示成 <code>travisbot</code>，一目了然，知道这个是自动提交的。而且配置文件似乎更简洁。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">before_script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="bullet">-g</span> <span class="string">hexo-cli</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">generate</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  provider:</span> <span class="string">pages</span></span><br><span class="line"><span class="attr">  skip-cleanup:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  keep-history:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  github-token:</span> <span class="string">$GITHUB_TOKEN</span></span><br><span class="line"><span class="attr">  local-dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">  target-branch:</span> <span class="string">master</span></span><br><span class="line"><span class="attr">  on:</span></span><br><span class="line"><span class="attr">    branch:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>
<p>在执行生成脚本之前只是全局安装 <code>hexo-cli</code>，然后执行 <code>hexo generate</code> 生成静态页面，然后利用 Travis CI 自动部署就完事儿啦，轻而易举，多么简洁。</p>
<p>后来我又发现好像并不用 <code>npm install -g hexo-cli</code>，原来这样写有点多余。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">before_script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="bullet">-g</span> <span class="string">hexo-cli</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">generate</span></span><br></pre></td></tr></table></figure>
<p>因为 <code>npm install</code> 的时候，安装的 <code>hexo</code> 包自带了 <code>hexo-cli</code>。</p>
<p>把 <code>before_script</code> 删掉，<code>script</code> 改成下面这样。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">./node_modules/hexo/bin/hexo</span> <span class="string">generate</span></span><br></pre></td></tr></table></figure>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/24/hexo-deploy-vs-travis-pages-provider/" data-id="cjnau2cvp0005w0ozva0v2s3e" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ci/">ci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/npm/">npm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pages/">pages</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travis/">travis</a></li></ul>
</footer>
</div>
</article>
<article id="post-xx-net-teredo-problem" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/24/xx-net-teredo-problem/" class="article-date">
<time datetime="2018-09-24T09:34:35.000Z" itemprop="datePublished">2018-09-24</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/24/xx-net-teredo-problem/">XX-Net Teredo 问题</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>偶尔用 <a href="https://github.com/XX-net/XX-Net" target="_blank" rel="noopener">XX-Net</a> 来访问 <a href="https://www.google.com/ncr" target="_blank" rel="noopener">Google</a>、<a href="https://developer.mozilla.org/" target="_blank" rel="noopener">MDN</a>。教育网原生 IPv6 可以完全正常使用 XX-net，但其他情况下需要 Teredo 隧道，然而我的电脑就是用不了，周围的人都可以，一直不知道为什么。</p>
<p>今天终发现于原因了：我刚装系统的时候手贱把很多防火墙规则都改成禁用了，然后默认就阻止连接了。</p>
<h2><span id="fa-xian-guo-cheng">发现过程</span><a href="#fa-xian-guo-cheng" class="header-anchor">#</a></h2><p>我今天再一次查看 <a href="https://github.com/XX-net/XX-Net/wiki/%E5%A6%82%E4%BD%95%E5%BC%80%E5%90%AFIPv6" target="_blank" rel="noopener">XX-Net IPv6 说明</a>，很随意的点开了 <a href="https://en.wikipedia.org/wiki/Teredo_tunneling" target="_blank" rel="noopener">Teredo Wikipedia</a>。简单浏览了一下，突然发现这个服务是需要开启 UDP 3544 端口。我猛然意识到我刚装系统之后，在防火墙中把大部分端口都禁了。</p>
<p><img src="/images/xx-net-teredo-problem/firewall-settings.jpg" alt="Windows Defender Firewall Advanced Settings"></p>
<p>在高级安全 Windows Defender 防火墙设置中，把与 IPv6 有关的条目都启用，再试了一下果然就成功了。</p>
<p>自己手欠啊！</p>
<p>我继续看 XX-Net 的 Wiki 中，FAQ 中提到了 <a href="https://support.xbox.com/zh-CN/xbox-on-windows/social/troubleshoot-party-chat" target="_blank" rel="noopener">Teredo Xbox Support</a>，点进去发现里面说了防火墙问题。</p>
<p>真是懒啊，没耐心去读文档。</p>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/24/xx-net-teredo-problem/" data-id="cjnau2cvw000aw0ozeylmi5pf" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gfw/">gfw</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/google/">google</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/teredo/">teredo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xx-net/">xx-net</a></li></ul>
</footer>
</div>
</article>
<article id="post-great-firewall-ssl-connection" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/22/great-firewall-ssl-connection/" class="article-date">
<time datetime="2018-09-22T15:11:47.000Z" itemprop="datePublished">2018-09-22</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/22/great-firewall-ssl-connection/">关于 GFW 的 SSL 连接检测</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>当访问 <a href="https://zh.wikipedia.org/" target="_blank" rel="noopener">https://zh.wikipedia.org/</a> 时会在 SSL 握手时直接被 RESET 或 ABORT，因为握手的时候是明文发送域名的。</p>
<p><img src="/images/great-firewall-ssl-connection/1.jpg" alt="zh wikipedia abort"></p>
<p>由于墙并没有去管 <a href="https://en.wikipedia.org/" target="_blank" rel="noopener">https://en.wikipedia.org/</a> 或 <a href="https://www.wikipedia.org/" target="_blank" rel="noopener">https://www.wikipedia.org/</a>，这两个网站可以正常访问，SSL 握手正常进行，Socket 成功连接了。</p>
<p><img src="/images/great-firewall-ssl-connection/2.jpg" alt="www wikipedia ok"></p>
<p>这时再访问 <a href="https://zh.wikipedia.org/" target="_blank" rel="noopener">https://zh.wikipedia.org/</a>，由于这两个网站在一个服务器上，可以直接使用刚才的 Socket，于是访问中文维基百科时完全处于加密中。</p>
<p><img src="/images/great-firewall-ssl-connection/3.jpg" alt="zh wikipedia use www ssl tunnel"></p>
<p>也就是说，假如能和对方成功建立起 SSL 连接，那么这种检测证书的方式就会被绕过。</p>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/22/great-firewall-ssl-connection/" data-id="cjnau2cvl0003w0oz0v3zco0i" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gfw/">gfw</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssl/">ssl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tunnel/">tunnel</a></li></ul>
</footer>
</div>
</article>
<article id="blog-grub-image" class="article article-type-blog" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/13/grub-image/" class="article-date">
<time datetime="2018-09-13T17:20:05.000Z" itemprop="datePublished">2018-09-14</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/13/grub-image/">Grub2 添加背景图片</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>今天尝试安装了一下 Ubuntu 18.04.1，现在安装系统越来越简单了，用 Rufus 做一个 U 盘启动盘，然后就正常下一步就行了，Ubuntu 直接提供安装 Windows 和 Ubuntu 双系统的选项。</p>
<p>安装之后想利用 Grub2 引导器页面的背景图片功能装个逼，把笔记本电脑厂商 logo 之后、Windows 启动之前那段黑屏加一个打着自己 logo 的背景图片。研究明白之后还是很简单的，不过查的过程还是挺麻烦的。</p>
<h2><span id="add-a-grub-background-image">Add a grub background image</span><a href="#add-a-grub-background-image" class="header-anchor">#</a></h2><p>First, add grub background image support.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install grub2-splashimages</span><br></pre></td></tr></table></figure>
<p>Then, copy a image to <code>/boot/grub/</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp bg.png /boot/grub/</span><br></pre></td></tr></table></figure>
<p>Now, you can use</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-grub</span><br></pre></td></tr></table></figure>
<p>to apply the change.</p>
<p>You can have a try now. And then, you will find that the 10 seconds timeout is really annoying.</p>
<h2><span id="no-timeout-and-no-menu">No timeout and no menu</span><a href="#no-timeout-and-no-menu" class="header-anchor">#</a></h2><p>Edit <code>/etc/default/grub</code>. Add or edit following settings.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GRUB_TIMEOUT_STYLE=hidden</span><br><span class="line">GRUB_TIMEOUT=1</span><br></pre></td></tr></table></figure>
<p>I will also set <code>GRUB_DEFAULT</code> to <code>2</code>, so the highlight selected default boot choice will be the 3rd option, which means <code>Windows boot manager</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRUB_DEFAULT=2</span><br></pre></td></tr></table></figure>
<p>It seems everything is ready, but grub do more things. Grub checks if you have multiple systems. If more than one system was found, grub will force <code>timeout_style</code> to be <code>menu</code>. This is not what we expected.</p>
<p>So open <code>/etc/grub.d/03_os-prober</code>, and remove the last line</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adjust_timeout</span><br></pre></td></tr></table></figure>
<p>Now, run <code>update-grub</code> and restart.</p>
<p>You can see the splash image and no menu is shown. Windows boot after a brief delay.</p>
<p>If you want to switch back to Ubuntu, you can press <code>Esc</code> during that 1 second timeout to get back the boot options menu, and select a different system to boot.</p>
<h2><span id="more-details">More details</span><a href="#more-details" class="header-anchor">#</a></h2><h3><span id="related-files-and-functions">Related files and functions</span><a href="#related-files-and-functions" class="header-anchor">#</a></h3><ul>
<li><code>/boot/grub/grub.cfg</code></li>
<li><code>/etc/default/grub</code></li>
<li><code>/etc/grub.d/00_header</code> function <code>make_timeout()</code></li>
<li><code>/etc/grub.d/03_os-prober</code> function <code>adjust_timeout()</code></li>
</ul>
<h3><span id="related-links">Related links</span><a href="#related-links" class="header-anchor">#</a></h3><ul>
<li><a href="https://help.ubuntu.com/community/Grub2/Displays" target="_blank" rel="noopener">Grub2 displays docs</a></li>
</ul>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/13/grub-image/" data-id="cjnau2cvn0004w0ozgfqy2wlx" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/grub/">grub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
</footer>
</div>
</article>
<article id="post-jekyll-vs-hexo" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/10/jekyll-vs-hexo/" class="article-date">
<time datetime="2018-09-10T13:51:47.000Z" itemprop="datePublished">2018-09-10</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/10/jekyll-vs-hexo/">Jekyll v.s. Hexo</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>最近我想用 <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> 搭建一个静态博客。最先想到的肯定是 <a href="https://jekyllrb.com/" target="_blank" rel="noopener">Jekyll</a> 了，因为这个东西是 GitHub 官方支持的。</p>
<p>通常来说，被 GitHub 所看中的项目，应该是非常不错的，不过用了之后才会发现一些问题。</p>
<p>这篇文章既包括正常的安装步骤，也包括一些吐槽，从中能发现对两者的一些看法。最后，我选择了使用 <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>。</p>
<div class="toc">
<ul>
<li><a href="#jekyll">Jekyll</a><ul>
<li><a href="#kuai-su-kai-shi-quickstart">快速开始 Quickstart</a></li>
<li><a href="#shi-ji-shang-wo-de-an-zhuang-guo-cheng">实际上我的安装过程</a></li>
<li><a href="#github-pages">GitHub Pages</a></li>
<li><a href="#zhu-ti">主题</a></li>
<li><a href="#xin-jian-wen-zhang">新建文章</a></li>
<li><a href="#gem-bao-ban-ben-chong-tu">Gem 包版本冲突</a></li>
<li><a href="#zui-zhong">最终</a></li>
</ul>
</li>
<li><a href="#tong-lei-chan-pin">同类产品</a></li>
<li><a href="#hexo">Hexo</a><ul>
<li><a href="#an-zhuang">安装</a></li>
<li><a href="#shi-ji-an-zhuang-guo-cheng">实际安装过程</a></li>
<li><a href="#xie-wen-zhang">写文章</a></li>
<li><a href="#github-pages-1">GitHub Pages</a></li>
</ul>
</li>
<li><a href="#zi-dong-gou-jian">自动构建</a><ul>
<li><a href="#cao-zuo-guo-cheng">操作过程</a></li>
<li><a href="#gai-jin-de-zi-dong-bu-shu">改进的自动部署</a></li>
</ul>
</li>
</ul>
</div>
<h2><span id="jekyll">Jekyll</span><a href="#jekyll" class="header-anchor">#</a></h2><p>那么我们按照官网的指示来一步一步操作。</p>
<h3><span id="kuai-su-kai-shi-quickstart">快速开始 Quickstart</span><a href="#kuai-su-kai-shi-quickstart" class="header-anchor">#</a></h3><ol>
<li><p>安装一个完全的 <a href="https://jekyllrb.com/docs/installation/" target="_blank" rel="noopener">Ruby 开发环境</a></p>
</li>
<li><p>安装 <code>Jekyll</code> 和 <code>bundler</code> 的 gem 包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install jekyll bundler</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>./myblog</code> 创建一个新的 Jekyll 网站</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jekyll new myblog</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入新的文件夹中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> myblog</span><br></pre></td></tr></table></figure>
</li>
<li><p>构建网站，使他可以在本地服务器访问</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle <span class="built_in">exec</span> jekyll serve</span><br></pre></td></tr></table></figure>
</li>
<li><p>现在可以访问 <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> 了</p>
</li>
</ol>
<h3><span id="shi-ji-shang-wo-de-an-zhuang-guo-cheng">实际上我的安装过程</span><a href="#shi-ji-shang-wo-de-an-zhuang-guo-cheng" class="header-anchor">#</a></h3><p>我是有 Web 开发基础的，安装软件和通过命令行执行命令都是小事，看上去安装过程很方便，那么我们开始吧。</p>
<p>我在安装软件的时候不喜欢选择经典（Typical）或者完全（Full）通常我会选择自定义（Custom），这样我可以看到他到底做了什么，所以我没有安装快速开始的过程直接安装，而是继续往下看开始章节（GETTING STARTED）中的其他介绍。</p>
<p>Ruby 入门（Ruby 101）这个我就不看了，毕竟我以不打算学 Ruby，我只需要知道怎么操作就行了。</p>
<p>我来看看安装（Installation）的内容。</p>
<blockquote>
<p>Jekyll 是一个可以安装在绝大多数系统的 Ruby Gem 包。</p>
</blockquote>
<p>要求：Ruby、RubyGems、GCC 和 Make。</p>
<ul>
<li>Ruby 和 RubyGems 这两个肯定没有问题，这个肯定是官方支持的。</li>
<li>GCC 是用来干什么的？不过没什么问题，大学里学过 C 语言，电脑里还留着呢（Dev-C++ 的 TDM-GCC 用着还不错）。</li>
<li><strong>为什么还要用到 Make 这种东西？在 Windows 下装 Make 感觉很麻烦啊！</strong></li>
</ul>
<p>暂时先不管，先继续往下看。下面我要看 Windows 下的安装说明。</p>
<blockquote>
<p>虽然 Windows 不是官方支持的平台，但可以通过适当的调整来运行Jekyll。此页面旨在收集 Windows 用户已发现的一些常识和经验教训。</p>
</blockquote>
<p>看到 <strong>不是官方支持</strong> 就感觉有些不想用这个，某些服务器软件官方不支持 Windows，这个我不会评论什么，但是给客户用的，为的是帮助用户解决日常写博客问题的软件，不官方支持 Windows 就有点令人反感了。</p>
<p>自己开的坑，至少研究明白再弃坑，我弄成功之后肯定要换个解决方案。</p>
<blockquote>
<p>运行 Jekyll 最简单的方法就是使用 <a href="https://rubyinstaller.org/" target="_blank" rel="noopener">RubyInstaller</a> for Windows</p>
</blockquote>
<p><strong>用 Installer 来安装其实挺方便的</strong> ，就不用自己配置 PATH 之类的，安装过程基本不会出现什么问题。</p>
<p>不过看到 <code>Ruby+Devkit</code> 版本，我就有点不高兴了。 <strong>我要运行一个 Ruby 的软件，为什么还要安装 Devkit</strong> 。难道不是像 Java 一样分为 JRE 和 JDK，如果只是运行 jar 只用 JRE 就够了？</p>
<p>那就先下载吧 <a href="https://github.com/oneclick/rubyinstaller2/releases/download/rubyinstaller-2.4.4-2/rubyinstaller-devkit-2.4.4-2-x64.exe" target="_blank" rel="noopener">rubyinstaller-devkit-2.4.4-2-x64.exe</a>。竟然要 115 MB，这什么鬼东西啊！Node.js 才 20MB，php 30MB，Chrome 也就 50MB， <strong>我为什么要为了写个博客装一个 115 MB 的东西</strong> 。</p>
<p>然后就安装吧，一路默认选项，反正我已经准备好卸载了。</p>
<p>然后运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install jekyll bundler</span><br></pre></td></tr></table></figure>
<p>然后经过漫长的等待，终于安装好了，国内网还是有点慢的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jekyll new myblog</span><br></pre></td></tr></table></figure>
<p>然后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> myblog</span><br><span class="line">jekyll serve</span><br></pre></td></tr></table></figure>
<p>访问 <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a>，终于成功访问了。</p>
<h3><span id="github-pages">GitHub Pages</span><a href="#github-pages" class="header-anchor">#</a></h3><p>GitHub 本身支持 Jekyll，可以自动编译 Jekyll 静态博客，直接按默认的 <code>.gitignore</code> Commit、Push 就行，部署起来应该不麻烦。</p>
<p>我新建了一个名为 <code>ganlvtech.github.io</code> 的仓库，然后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"Initial commit"</span></span><br><span class="line">git remote add origin git@github.com:ganlvtech/ganlvtech.github.io.git</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
<p>就行了。</p>
<p>其实我用的是 Git GUI</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git gui</span><br></pre></td></tr></table></figure>
<p>然后就可以到 <a href="https://github.com/ganlvtech/ganlvtech.github.io/settings" target="_blank" rel="noopener">仓库设置</a> 中启用 GitHub Pages，</p>
<p>然后问题就来了，静态页面的 CSS 文件加载不出来，不知道为什么。</p>
<p>我怀疑可能是 GitHub 不支持 minima 这个主题，我尝试修改设置里的“主题”选项，改了之后也没用。</p>
<p>经过一番 Bing 搜索，我找到了 <a href="https://help.github.com/articles/about-github-pages-and-jekyll/#jekyll-site-examples" target="_blank" rel="noopener">About GitHub Pages and Jekyll</a></p>
<blockquote>
<p>We recommend using Jekyll if you want the built-in support it offers, including the <a href="https://github.com/github/pages-gem" target="_blank" rel="noopener">GitHub Pages gem</a> to manage dependencies, specific build failure messages, and more specific help with troubleshooting.</p>
</blockquote>
<p>我就打开 <a href="https://github.com/github/pages-gem" target="_blank" rel="noopener">GitHub Pages gem</a> 这个链接看了一下，也没太看明白</p>
<p>我在 <code>Gemfile</code> 最后添加了一行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem &apos;github-pages&apos;, group: :jekyll_plugins</span><br></pre></td></tr></table></figure>
<p>然后 Commit、Push，果然可以正常访问 <a href="https://ganlvtech.github.io/">https://ganlvtech.github.io/</a> 了。</p>
<h3><span id="zhu-ti">主题</span><a href="#zhu-ti" class="header-anchor">#</a></h3><p>GitHub 官方支持的主题实在不符合我的审美要求，我在 GitHub 全仓库搜索 <code>jekyll</code> 按 Star 排序挨个看，终于找到一个我感觉很舒服的主题，<a href="https://github.com/kaeyleo/jekyll-theme-H2O" target="_blank" rel="noopener">H2O</a>。</p>
<p>浏览过程中我发现，Jekyll 主题的下载方法竟然不是通过包管理器下载，而是手动克隆仓库，相当于把模板和 CSS 文件下载下来。</p>
<p>感觉这种方法有些过时，不过也没有问题，因为自己的博客要有个性化，改 CSS 应该是很常见的问题。</p>
<p>我下载了这个主题，感觉还不错，准备先写篇博客，然后再把主题部署上去吧，要不这个主题可能会显得光秃秃的。</p>
<h3><span id="xin-jian-wen-zhang">新建文章</span><a href="#xin-jian-wen-zhang" class="header-anchor">#</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jekyll <span class="built_in">help</span></span><br></pre></td></tr></table></figure>
<p>哇！ <strong>Jekyll 竟然没有自动新建文章的功能</strong> 。</p>
<p>Bing 一下 <code>jekyll new post</code>，结果真的没有，这个根本就不人性化，难道每次我新建文章都得自己输入日期，自己把文件前面的描述复制过来。</p>
<blockquote>
<p>自己选的 Jekyll，死也要把这个东西弄完。</p>
</blockquote>
<h3><span id="gem-bao-ban-ben-chong-tu">Gem 包版本冲突</span><a href="#gem-bao-ban-ben-chong-tu" class="header-anchor">#</a></h3><p>本来以为问题都解决了，我也没怎么多想，我就用 <a href="https://code.visualstudio.com/" target="_blank" rel="noopener">vscode</a> 写了一篇博客，vscode 自带的感觉还不错。想在 Push 之前看看效果，运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jekyll serve --watch</span><br></pre></td></tr></table></figure>
<p>然后就提示问题了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Bundler could not find compatible versions for gem &quot;jekyll&quot;: (Bundler::VersionConflict)</span><br><span class="line">  In Gemfile:</span><br><span class="line">    jekyll (~&gt; 3.8.3) x64-mingw32</span><br><span class="line"></span><br><span class="line">    github-pages x64-mingw32 was resolved to 191, which depends on</span><br><span class="line">      jekyll (= 3.7.3) x64-mingw32</span><br></pre></td></tr></table></figure>
<p><code>github-pages</code> 这个 Gem 包竟然是要求版本完全相等，都不能向以后版本兼容。我都想骂人了，那种“有最新版，然而我不能用”的感觉感觉很不爽，而且还是因为一个对我本地运行无作用的包。</p>
<h3><span id="zui-zhong">最终</span><a href="#zui-zhong" class="header-anchor">#</a></h3><p>我想想就到这里吧，我要去寻找替代品了。</p>
<h2><span id="tong-lei-chan-pin">同类产品</span><a href="#tong-lei-chan-pin" class="header-anchor">#</a></h2><p>搜索一下 <code>Jekyll Alternatives</code>，WordPress 肯定是最多的啦，当然我们要的是静态博客，还有 <a href="https://github.com/gohugoio/hugo" target="_blank" rel="noopener">Hugo</a> 和 <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>，对比一下：</p>
<ul>
<li>GitHub 上 Star 数差不多</li>
<li>Hexo 有中文文档，很多贡献者都是中国人</li>
<li>Hexo 之前我听说过</li>
<li>Hugo 有已编译版本，不需要下载 Go 的环境</li>
<li>我对 Node.js npm 比较熟悉</li>
</ul>
<p>由于我对 javascript 还是比较了解的，我想了解一下 Hexo 代码的结构，学习一下其他人代码的写法，所以我选择了 Hexo。</p>
<h2><span id="hexo">Hexo</span><a href="#hexo" class="header-anchor">#</a></h2><h3><span id="an-zhuang">安装</span><a href="#an-zhuang" class="header-anchor">#</a></h3><p>安装 Hexo 相当简单。然而在安装前，您必须检查电脑中是否已安装下列应用程序：</p>
<ul>
<li><a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">Node.js</a></li>
<li><a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a></li>
</ul>
<p>如果您的电脑中已经安装上述必备程序，那么恭喜您！接下来只需要使用 npm 即可完成 Hexo 的安装。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<h3><span id="shi-ji-an-zhuang-guo-cheng">实际安装过程</span><a href="#shi-ji-an-zhuang-guo-cheng" class="header-anchor">#</a></h3><p>完全没有任何问题。</p>
<p>访问 <a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">Node.js 官方网站</a>，直接点击下载最新版的按钮就行。然后安装时一路确定就行了。</p>
<p>（既然都用 GitHub Pages 了，不可能没装 Git 吧。访问 <a href="https://git-scm.com/" target="_blank" rel="noopener">Git 官方网站</a>，下载最新版，安装时同样一路确定。）</p>
<p>执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<p>在中国，如果直接用 npm 的话，下载速度可能有点慢，在执行 <code>npm install</code> 之前改一下 npm 设置就行了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org -g</span><br></pre></td></tr></table></figure>
<p>然后再</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init myblog</span><br><span class="line"><span class="built_in">cd</span> myblog</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure>
<p>访问 <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a>，我已经看到了成果。</p>
<h3><span id="xie-wen-zhang">写文章</span><a href="#xie-wen-zhang" class="header-anchor">#</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post <span class="string">"New Blog"</span></span><br></pre></td></tr></table></figure>
<p>多么舒服的操作啊。</p>
<p>在 <code>_config.yml</code> 中可以设置默认的文件名格式，可以手动设置成像 Jekyll 那种带日期的文件名。</p>
<h3><span id="github-pages">GitHub Pages</span><a href="#github-pages" class="header-anchor">#</a></h3><p>这个可能是最麻烦的了，因为 GitHub Pages 默认只支持 Jekyll，所以我们必须本地编译成静态网站，然后再用 git 上传到 GitHub。</p>
<p>但是，Hexo 自带 deploy 功能。</p>
<p>先安装 git deployer</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>然后设置一下 <code>_config.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="string">git@github.com:ganlvtech/ganlvtech.github.io.git</span></span><br><span class="line"><span class="attr">  branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
<p>最后执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
<p>完美！</p>
<h2><span id="zi-dong-gou-jian">自动构建</span><a href="#zi-dong-gou-jian" class="header-anchor">#</a></h2><p>那么，我怎么像 Jekyll 那样，上传 Markdown 自动编译成 HTML 呢？</p>
<p><a href="https://travis-ci.org/" target="_blank" rel="noopener">Travis CI</a> - Test and Deploy with Confidence</p>
<p>这是一个专门面向 GitHub 的持续集成的工具，可以干很多复杂的东西，部署一个博客简直太简单了。</p>
<h3><span id="cao-zuo-guo-cheng">操作过程</span><a href="#cao-zuo-guo-cheng" class="header-anchor">#</a></h3><p>首先，登录这个网站，直接通过 GitHub 的 OAuth 登录就行了。</p>
<p>然后，在设置中找到这个网站，激活这个网站的持续集成。</p>
<p>接下来，新建一个 <code>.travis.yml</code> 然后填入以下内容</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">node_js:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"node"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branches:</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="attr">before_script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="bullet">-g</span> <span class="string">hexo-cli</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"Ganlv"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"nospam@example.com"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">sed</span> <span class="bullet">-i</span> <span class="string">"s/git@github.com:/https:\/\/$&#123;__GITHUB_TOKEN__&#125;@github.com\//"</span> <span class="string">_config.yml</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">clone</span> <span class="bullet">-b</span> <span class="string">master</span> <span class="attr">https://github.com/ganlvtech/ganlvtech.github.io.git</span> <span class="string">.deploy_git</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">deploy</span></span><br></pre></td></tr></table></figure>
<p>注意，这里需要去 GitHub / Settings / Developer / <a href="https://github.com/settings/tokens" target="_blank" rel="noopener">Personal access tokens</a> 去新建一个拥有 <code>public_repo</code> 权限的 <code>token</code>。然后在 Travis CI 中这个项目的设置中添加一条 <code>__GITHUB_TOKEN__</code> 的环境变量。</p>
<p>最后把原始的代码 push 到 dev 分支就可以了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git branch -m master dev</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"Use Travis-CI"</span></span><br><span class="line">git remote add origin git@github.com:ganlvtech/ganlvtech.github.io.git</span><br><span class="line">git push origin dev</span><br></pre></td></tr></table></figure>
<p>Travis 会根据设置自动为我们构建项目，并且推送到 master 分支。</p>
<h3><span id="gai-jin-de-zi-dong-bu-shu">改进的自动部署</span><a href="#gai-jin-de-zi-dong-bu-shu" class="header-anchor">#</a></h3><p>参考另一篇文章 <a href="/2018/09/24/hexo-deploy-vs-travis-pages-provider/">hexo deploy v.s. Travis Pages provider</a></p>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/10/jekyll-vs-hexo/" data-id="cjnau2cwp002ow0ozlzu50pao" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ci/">ci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/comparison/">comparison</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gem/">gem</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jekyll/">jekyll</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/npm/">npm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pages/">pages</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ruby/">ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travis/">travis</a></li></ul>
</footer>
</div>
</article>
<article id="post-build-a-php-site-from-scratch" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2018/09/05/build-a-php-site-from-scratch/" class="article-date">
<time datetime="2018-09-05T10:10:43.000Z" itemprop="datePublished">2018-09-05</time>
</a>
</div>
<div class="article-inner">
<header class="article-header">
<h1 itemprop="name">
<a class="article-title" href="/2018/09/05/build-a-php-site-from-scratch/">从零开始写一个 PHP 网站</a>
</h1>
</header>
<div class="article-entry" itemprop="articleBody">
<p>《年薪百万程序员教你两个小时写出淘宝网站》，你的首页推荐似乎已经不堪入目了。</p>
<p>我不是年薪百万的程序员，我也不能两个小时写出淘宝网站，我就是一个热爱互联网技术的热爱学习的业余程序员。虽然如此，但是这篇文章将带你从零开始写一个 PHP 网站。</p>
<p>这篇文章有点类似 <code>Hello, world!</code>，就是那种你只要照着我说的去做就行了，至于为什么这么做，做完之后你自己去慢慢理解。</p>
<div class="toc">
<ul>
<li><a href="#shou-xian-ni-xu-yao-you-yi-tai-dian-nao">首先你需要有一台电脑</a></li>
<li><a href="#an-zhuang-chrome">安装 Chrome</a></li>
<li><a href="#an-zhuang-php">安装 PHP</a></li>
<li><a href="#huan-jing-bian-liang-path">环境变量 PATH</a></li>
<li><a href="#to-be-continued">To Be Continued</a></li>
<li><a href="#an-zhuang-mariadb-shu-ju-ku">安装 MariaDB 数据库</a></li>
<li><a href="#an-zhuang-composer">安装 Composer</a></li>
<li><a href="#xin-jian-laravel-xiang-mu">新建 Laravel 项目</a><ul>
<li><a href="#an-zhuang-laravel-installer">安装 Laravel Installer</a></li>
<li><a href="#xin-jian-laravel-ying-yong">新建 Laravel 应用</a></li>
</ul>
</li>
<li><a href="#xie-dai-ma">写代码</a><ul>
<li><a href="#pei-zhi-wen-jian">配置文件</a></li>
<li><a href="#qi-dong-kai-fa-fu-wu-qi">启动开发服务器</a></li>
<li><a href="#hou-duan-dai-ma">后端代码</a></li>
<li><a href="#qian-duan-dai-ma">前端代码</a></li>
</ul>
</li>
<li><a href="#github">GitHub</a></li>
</ul>
</div>
<h2><span id="shou-xian-ni-xu-yao-you-yi-tai-dian-nao">首先你需要有一台电脑</span><a href="#shou-xian-ni-xu-yao-you-yi-tai-dian-nao" class="header-anchor">#</a></h2><p>虽然说电脑现在已经很普遍了，但是如果你是用手机看这篇文章并且只有一部手机，那么我推荐你，为了您更好的编程体验，买一台电脑。</p>
<p>PHP 编程并不需要多么强大的电脑，3000 元人民币的笔记本电脑都可以完美胜任。</p>
<blockquote>
<p>我推荐您选用自带 Windows 10 操作系统的电脑，这可能为您避免许多麻烦。</p>
</blockquote>
<h2><span id="an-zhuang-chrome">安装 Chrome</span><a href="#an-zhuang-chrome" class="header-anchor">#</a></h2><p>现在你用的是一台全新的电脑。</p>
<p>我推荐，开机之后你要装的第一个软件是 <a href="https://www.google.cn/chrome/" target="_blank" rel="noopener">Chrome 浏览器</a>，我使用 <a href="https://www.chrome64bit.com/" target="_blank" rel="noopener">Chrome 64-bit</a> 这个非官方网站下载离线安装包。</p>
<p>Chrome 是全自动安装，下载完安装包之后，双击运行即可。</p>
<blockquote>
<p>安装位置是 <code>C:\Users\用户名\AppData\Local\Google\Chrome\Application</code>，这个目前并不重要。</p>
</blockquote>
<h2><span id="an-zhuang-php">安装 PHP</span><a href="#an-zhuang-php" class="header-anchor">#</a></h2><p>到 <a href="http://php.net/" target="_blank" rel="noopener">PHP 官方网站</a> 下载最新版 PHP，因为我们使用的是 Windows，所以去 <a href="https://windows.php.net/download/" target="_blank" rel="noopener">PHP For Windows</a> 下载，推荐使用最新版的 <code>VC15 x64 Non Thread Safe</code> 版本。</p>
<blockquote>
<p>下载页面旁边的 “Which version do I choose?” 介绍了如何选择版本，如果您有兴趣可以看一看。</p>
</blockquote>
<p>PHP 是免安装的，下载之后解压到某个文件夹即可使用。我是将 PHP 解压到了 <code>C:\Program1\php</code>。</p>
<blockquote>
<p>如果你想知道原因的话，解释如下：</p>
<p>对于需要安装的程序，安装程序默认会安装到 <code>C:\Program Files</code>，那么对于免安装程序，我也统一放在一个位置，因为 <code>C:\Program Files</code> 这个文件夹是需要管理员权限访问的，所以我们使用这个文件夹将带来诸多不便，所以就另外建一个文件夹，最开始我使用的是 <code>C:\Program</code>，但是重启之后系统提示这样命名可能会存在问题，将其改成了 <code>C:\Program1</code>，我也就这样沿用下来了。</p>
</blockquote>
<h2><span id="huan-jing-bian-liang-path">环境变量 PATH</span><a href="#huan-jing-bian-liang-path" class="header-anchor">#</a></h2><p>之后可能经常要跟命令行打交道，设置 <code>PATH</code> 可以让你从任何位置轻松地访问 <code>php.exe</code>。</p>
<p>按 <code>Win + S</code> 打开 Cortana，输入 <code>环境变量</code>，即可找到 <code>编辑系统环境变量</code> 的选项。</p>
<blockquote>
<p>这里的 <code>S</code> 表示 <code>Search</code></p>
</blockquote>
<p>选择 <code>环境变量</code>，在下方的 <code>系统变量</code>中找到<code>PATH</code>，双击这一行，弹出修改框，然后点击添加，在最后一行输入 <code>C:\Program1\php</code> 即可。</p>
<p>这时使用 <code>Win + R</code> 打开运行窗口，输入 <code>cmd</code> 回车。在弹出的命令行窗口中输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure>
<p>成功显示版本号了，证明你可以从任何位置访问 <code>php</code> 了。</p>
<h2><span id="to-be-continued">To Be Continued</span><a href="#to-be-continued" class="header-anchor">#</a></h2><p>Images will comming soon.</p>
<h2><span id="an-zhuang-mariadb-shu-ju-ku">安装 MariaDB 数据库</span><a href="#an-zhuang-mariadb-shu-ju-ku" class="header-anchor">#</a></h2><p>存数据总不能像大学计算机 C 语言课程上，都是操作文本文件吧，我们要用一个更牛逼的东西——数据库。</p>
<p>我用的是 <a href="https://mariadb.org/" target="_blank" rel="noopener">MariaDB</a>，到 <a href="https://downloads.mariadb.org/" target="_blank" rel="noopener">下载页面</a> 去下载一个最新版就行了。</p>
<h2><span id="an-zhuang-composer">安装 Composer</span><a href="#an-zhuang-composer" class="header-anchor">#</a></h2><p>代码不能全是自己写，有现成的就用现成的，<a href="https://getcomposer.org/" target="_blank" rel="noopener">Composer</a> 可以自动帮我们下载 <a href="https://packagist.org/" target="_blank" rel="noopener">Packagist</a> 上面现成的包。</p>
<p>到 <a href="https://getcomposer.org/download/" target="_blank" rel="noopener">Composer 下载页面</a> 中下载 <code>Composer-Setup.exe</code> 正常安装即可。</p>
<h2><span id="xin-jian-laravel-xiang-mu">新建 Laravel 项目</span><a href="#xin-jian-laravel-xiang-mu" class="header-anchor">#</a></h2><p>php 网站可以全部由自己从头写起，不过开发效率太低，我使用 <a href="https://laravel.com/" target="_blank" rel="noopener">Laravel</a> 这个框架。</p>
<p>使用框架，我们不用考虑如何操作数据库等等细节内容，我们只需要完成每个页面的逻辑过程就行了。</p>
<h3><span id="an-zhuang-laravel-installer">安装 Laravel Installer</span><a href="#an-zhuang-laravel-installer" class="header-anchor">#</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer global require <span class="string">"laravel/installer"</span></span><br></pre></td></tr></table></figure>
<h3><span id="xin-jian-laravel-ying-yong">新建 Laravel 应用</span><a href="#xin-jian-laravel-ying-yong" class="header-anchor">#</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">laravel new myapp</span><br></pre></td></tr></table></figure>
<p>然后进入这个文件夹。</p>
<h2><span id="xie-dai-ma">写代码</span><a href="#xie-dai-ma" class="header-anchor">#</a></h2><p>要学习这个框架，可以参考 <a href="https://laracasts.com/series/laravel-from-scratch-2017" target="_blank" rel="noopener">Laravel 5.4 from scratch</a> 视频教程。如果有任何问题，应该首先查找 <a href="https://laravel.com/docs/" target="_blank" rel="noopener">Laravel 说明文档</a>。</p>
<h3><span id="pei-zhi-wen-jian">配置文件</span><a href="#pei-zhi-wen-jian" class="header-anchor">#</a></h3><p><code>.env</code> 文件</p>
<p><code>config</code> 文件夹</p>
<h3><span id="qi-dong-kai-fa-fu-wu-qi">启动开发服务器</span><a href="#qi-dong-kai-fa-fu-wu-qi" class="header-anchor">#</a></h3><p>我们需要一边写代码，一边看效果。Laravel 给我们提供了一个开发服务器，直接运行下面这条命令即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan serve</span><br></pre></td></tr></table></figure>
<h3><span id="hou-duan-dai-ma">后端代码</span><a href="#hou-duan-dai-ma" class="header-anchor">#</a></h3><p>10 倍速快进（此处省略 3000 行代码）</p>
<h3><span id="qian-duan-dai-ma">前端代码</span><a href="#qian-duan-dai-ma" class="header-anchor">#</a></h3><p>10 倍速快进（此处省略 3000 行代码）</p>
<h2><span id="github">GitHub</span><a href="#github" class="header-anchor">#</a></h2><p>写完的项目我们可以放到 GitHub 开放给其他人。</p>
</div>
<footer class="article-footer">
<a data-url="https://ganlvtech.github.io/2018/09/05/build-a-php-site-from-scratch/" data-id="cjnau2cv40000w0oz237iq6rg" class="article-share-link">Share</a>
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PATH/">PATH</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/chrome/">chrome</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/composer/">composer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/installation/">installation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/laravel/">laravel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mariadb/">mariadb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tutorial/">tutorial</a></li></ul>
</footer>
</div>
</article>
</section>
<aside id="sidebar">
<div class="widget-wrap">
<h3 class="widget-title">标签</h3>
<div class="widget">
<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/PATH/">PATH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ci/">ci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/comparison/">comparison</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/composer/">composer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devtools/">devtools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/frontend/">frontend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftp/">ftp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gem/">gem</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gfw/">gfw</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google/">google</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gooreplacer/">gooreplacer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grub/">grub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/i18n/">i18n</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/installation/">installation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jekyll/">jekyll</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/laravel/">laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/locale/">locale</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mariadb/">mariadb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pages/">pages</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/production/">production</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pure-ftpd/">pure-ftpd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resource-override/">resource-override</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ruby/">ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssl/">ssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/teredo/">teredo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tls/">tls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/travis/">travis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tunnel/">tunnel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tutorial/">tutorial</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xx-net/">xx-net</a></li></ul>
</div>
</div>
<div class="widget-wrap">
<h3 class="widget-title">标签云</h3>
<div class="widget tagcloud">
<a href="/tags/PATH/" style="font-size:10px">PATH</a> <a href="/tags/chrome/" style="font-size:15px">chrome</a> <a href="/tags/ci/" style="font-size:15px">ci</a> <a href="/tags/comparison/" style="font-size:10px">comparison</a> <a href="/tags/composer/" style="font-size:10px">composer</a> <a href="/tags/css/" style="font-size:10px">css</a> <a href="/tags/devtools/" style="font-size:10px">devtools</a> <a href="/tags/frontend/" style="font-size:10px">frontend</a> <a href="/tags/ftp/" style="font-size:10px">ftp</a> <a href="/tags/gem/" style="font-size:10px">gem</a> <a href="/tags/gfw/" style="font-size:20px">gfw</a> <a href="/tags/github/" style="font-size:15px">github</a> <a href="/tags/google/" style="font-size:10px">google</a> <a href="/tags/gooreplacer/" style="font-size:10px">gooreplacer</a> <a href="/tags/grub/" style="font-size:10px">grub</a> <a href="/tags/hexo/" style="font-size:15px">hexo</a> <a href="/tags/html/" style="font-size:10px">html</a> <a href="/tags/i18n/" style="font-size:10px">i18n</a> <a href="/tags/installation/" style="font-size:10px">installation</a> <a href="/tags/jekyll/" style="font-size:10px">jekyll</a> <a href="/tags/js/" style="font-size:10px">js</a> <a href="/tags/laravel/" style="font-size:10px">laravel</a> <a href="/tags/linux/" style="font-size:10px">linux</a> <a href="/tags/locale/" style="font-size:10px">locale</a> <a href="/tags/mariadb/" style="font-size:10px">mariadb</a> <a href="/tags/node-js/" style="font-size:15px">node.js</a> <a href="/tags/npm/" style="font-size:15px">npm</a> <a href="/tags/pages/" style="font-size:15px">pages</a> <a href="/tags/php/" style="font-size:10px">php</a> <a href="/tags/production/" style="font-size:10px">production</a> <a href="/tags/pure-ftpd/" style="font-size:10px">pure-ftpd</a> <a href="/tags/resource-override/" style="font-size:10px">resource-override</a> <a href="/tags/ruby/" style="font-size:10px">ruby</a> <a href="/tags/ssl/" style="font-size:15px">ssl</a> <a href="/tags/teredo/" style="font-size:10px">teredo</a> <a href="/tags/test/" style="font-size:10px">test</a> <a href="/tags/tls/" style="font-size:10px">tls</a> <a href="/tags/travis/" style="font-size:15px">travis</a> <a href="/tags/tunnel/" style="font-size:10px">tunnel</a> <a href="/tags/tutorial/" style="font-size:10px">tutorial</a> <a href="/tags/ubuntu/" style="font-size:20px">ubuntu</a> <a href="/tags/xx-net/" style="font-size:10px">xx-net</a>
</div>
</div>
<div class="widget-wrap">
<h3 class="widget-title">归档</h3>
<div class="widget">
<ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li></ul>
</div>
</div>
<div class="widget-wrap">
<h3 class="widget-title">最新文章</h3>
<div class="widget">
<ul>
<li>
<a href="/2018/10/15/chrome-local-override/">Chrome Local Override 本地文件替换</a>
</li>
<li>
<a href="/2018/10/08/install-pure-ftpd-enable-tls/">安装 Pure-FTPd 并启用 TLS</a>
</li>
<li>
<a href="/2018/09/28/ubuntu-font-noto-sans-cjk-problem/">Ubuntu Use Noto Sans CJK SC as Default Fallback Font</a>
</li>
<li>
<a href="/2018/09/24/hexo-deploy-vs-travis-pages-provider/">hexo deploy v.s. Travis Pages provider</a>
</li>
<li>
<a href="/2018/09/24/xx-net-teredo-problem/">XX-Net Teredo 问题</a>
</li>
</ul>
</div>
</div>
</aside>
</div>
<footer id="footer">
<div class="outer">
<div id="footer-info" class="inner">
&copy; 2018 Ganlv<br>
Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
</div>
</div>
</footer>
</div>
<nav id="mobile-nav">
<a href="/" class="mobile-nav-link">Home</a>
<a href="/archives" class="mobile-nav-link">Archives</a>
</nav>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script src="/js/BSOD.js"></script>
<script src="/js/script.js"></script>
</div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
